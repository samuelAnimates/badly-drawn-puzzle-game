<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>jQuery RPG</title>

    <!-- link to the jQuery Library -->
    <script src="https://code.jquery.com/jquery-3.1.1.js"></script>

	<!-- link to this game's custom JS code -->
    <script src="assets/javascript/game.js"></script>

    <!-- link to Bootstrap-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

	<!-- link to custom stylesheet-->
    <link rel="stylesheet" href="assets/css/style.css">

    <!-- link to annoying Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Tangerine|VT323" rel="stylesheet">

</head>
<body>

	<!-- Container for whole game page -->
	<main class="container">

		<!-- Game title and heading -->
		<header class= "row text-center">
			<span class="font-40-px font-comicsans">Badly Drawn </span>
			<span class="font-40-px font-handwriting">Fairy Tale </span>
			<span class="font-40-px font-bold font-impact font-wt-bold">Battle </span>
			<span class="font-40-px font-pixels">RPG </span>
			<div class="font-24-px font-handwriting row text-center">
			&#9835;&#9834;Some day my graphic designer will come...
			</div>
		</header>

		<!-- Container for fighter profiles-->
		<section class="col-xs-12 col-sm-6 col-md-4 col-lg-4">
			
			<header class="row text-center" id="lefthand-header">
				SELECT YOUR FIGHTER
			</header>

			
			<div class="row text-center" id="fighters-container"></div>

			
		</section> 

		<!-- Container for Battle Arena -->
		<section class="bg-red col-xs-12 col-sm-6 col-md-6 col-md-offset-1 col-lg-6 col-lg-offset-1">

			<header class="row text-center">BATTLE ARENA</header>

			<!-- Container for user-selected fighter profile-->
			<div class="text-center">	
				<div class="row bg-blue" id="user-container"></div>
				<div class="row">YOU &uarr;</div>
			</div>
			
			<div class="row" id="buttons-row">
				<button type="button" class="btn btn-primary center-block" id="attack-btn">ATTACK!</button>
				<button type='button' class='btn btn-success center-block' id='reset-btn'>PLAY AGAIN</button>
			</div>

			<!-- Container for opponent profile -->
			<div class="text-center">	
				<div class="row">YOUR OPPONENT &darr;</div>
				<div class="row bg-yellow" id="opponent-container"></div>
			</div>

		</section>

	</main>

<script type="text/javascript">


	//display the roster of potential fighters in the fighters-container div
	for (i = 0; i < fightersArray.length; i++){
		var fighterRosterDisplayDiv = $("#fighters-container");
		loadFighterProfile(i, fighterRosterDisplayDiv, "null");
	}

	//declare variables to keep track of user's stats
	var userSelectionId = null;
	var userFighter = null;
	var userHPValue = null;
	var userAttackValueRaise = null;
	var userAttackValue = null;

	//declare variables to keep track of current opponent stats
	var opponentId = null;
	var opponentFighter = null;
	var opponentHPValue = null;
	var opponentCounterattackValue = null;
	var opponentsToBeatNumber = fightersArray.length;

	$("#reset-btn").hide();

	$("#fighters-container").on("click", ".JS-fighter-picture", function() {

		if(userSelectionId == null && opponentId == null){
			
			//Set the user's baseline fighter stats based on their selection
			userSelectionId = parseInt($(this).attr("value"));
			userFighter = fightersArray[userSelectionId];
			userHPValue = userFighter.healthPoints;
			userAttackValue = userFighter.attackPower;
			userAttackValueRaise = userFighter.attackPower;

			//Delete the user's selection from the roster and load it to the Battle Arena
			$(this).closest(".fighter-profile").remove();
			displayContainerUserSelection = $("#user-container");
			loadFighterProfile(userSelectionId, displayContainerUserSelection, "user");
			opponentsToBeatNumber = opponentsToBeatNumber - 1;
			$("#lefthand-header").html("SELECT YOUR OPPONENT");

		}

		else if (userSelectionId !== null && opponentId == null){
			
			//Set the opponent's baseline fighter stats
			opponentId = $(this).attr("value");
			opponentFighter = fightersArray[opponentId];
			opponentHPValue = opponentFighter.healthPoints;
			opponentCounterattackValue = opponentFighter.counterattackPower;

			displayContainerOpponentSelection = $("#opponent-container");

			//remove user's selected opponent from the roster sections and display them in the Battle Arena
			$(this).closest(".fighter-profile").remove();
			loadFighterProfile(opponentId, displayContainerOpponentSelection, "opponent");
		}
		
	});

	$("#attack-btn").on("click", function(){
		if(opponentHPValue > 0){
			//change user's HP/Attack and opponent's HP, print user/opponent stats to the Battle Arena.
			opponentHPValue = opponentHPValue - userAttackValue;
			userHPValue = userHPValue - opponentCounterattackValue;
			userAttackValue = userAttackValue + userAttackValueRaise;
			$("#opponent.JS-stats-HP").html("HP: " + opponentHPValue);
			$("#user.JS-stats-HP").html("HP: " + userHPValue);
			$("#user.JS-stats-attack").html("Attack: " + userAttackValue);

			//if this last attack has zeroed the opponent's HP, clear them from the Battle Arena and null all the opponent stats
			if (opponentHPValue <= 0){
				$("#opponent-container").html(" ");
				opponentsToBeatNumber = opponentsToBeatNumber - 1;
				nullOpponent();
					//If there are no opponents left to beat, display message and disable attack button.
					if(opponentsToBeatNumber == 0){
						$("#attack-btn").addClass("disabled");
						$("#reset-btn").show();
						$("#opponent-container").html("YAY, YOU WON!<br>TRY AGAIN?");
					}
			}

			//if this last counterattack has zeroed the user's HP, clear them from the Battle Arena, display message, and disable attack button.
			if (userHPValue <= 0){
				$("#user-container").html("OOPS. YOU LOST!<br>TRY AGAIN.");
				$("#attack-btn").addClass("disabled");
				$("#reset-btn").show();
			}
		}

	});

	$("#reset-btn").on("click", function() {
		
		$("#fighters-container").html("");
		$("#opponent-container").html("");
		$("#user-container").html("");
		$("#reset-btn").hide();
		$("#attack-btn").removeClass("disabled");
		
		
		for (i = 0; i < fightersArray.length; i++){
			var fighterRosterDisplayDiv = $("#fighters-container");
			loadFighterProfile(i, fighterRosterDisplayDiv, "null");
		};

		nullUser();
		nullOpponent();
		var opponentsToBeatNumber = fightersArray.length;
		

	});

</script>

</body>
</html>